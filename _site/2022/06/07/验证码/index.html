<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="还没有更好的描述呢">
    <meta name="keywords"  content="yuan, 920 Blog, 永震的博客, 920, 永震, iOS, Apple, iPhone">
    <meta name="theme-color" content="#fff">
    
    <title>验证码 - Yuan's Blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <!-- <link rel="shortcut icon" href="/img/favicon.ico"> -->
    <link rel="shortcut icon" href="/img/apple-touch-icon.png">

    <!-- Safari Webpage Icon    by-BY -->
    <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://yuan920.github.io/2022/06/07/%E9%AA%8C%E8%AF%81%E7%A0%81/">

    <!-- Bootstrap Core CSS -->
    <!-- <link rel="stylesheet" href="/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="/css/bootstrap.css?t=1">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css?t=5">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Yuan's Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                    
                        
                    
                        
                            <li>
                                <a href="/about/">About</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            <li>
                                <a href="/tags/">Tags</a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/uniapp/">uniapp</a>
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-desk.png" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        /*background-image: url('/img/post-bg-desk.png')*/
        background-color: #969696;
        
    }

    
</style>

<header class="intro-header" >
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#验证码" title="验证码">验证码</a>
                        
                    </div>
                    <h1>验证码</h1>
                    
                    
                    <h2 class="subheading">方框、横线类型输入框</h2>
                    

                    <span class="meta">
                    
                        920
                    
                    </span>
                    <span class="meta" style="font-size: 13px;padding-top: 15px;">
                        <!-- <strong>发布:</strong>  2022/6/7 15:06 -->
                        
                            <strong>发布:</strong>  2022/6/7 15:06
                        
                    </span>
                    <span id="busuanzi_container_page_uv" class="meta" style="font-size: 13px;padding-top: 15px;">
                        本文总阅读量<span id="busuanzi_value_page_pv"></span>次
                    </span>
                    
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				    <h4 id="使用方法">使用方法</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 头文件  
#import "RKCodeInputView.h"

// 属性
@property(nonatomic,strong)RKCodeInputView *codeInputView;  /// 输入框

_codeInputView = [[RKCodeInputView alloc]init];
_codeInputView.contentView.backgroundColor = UIColor.whiteColor;
// 明文、密文
_codeInputView.secureTextEntry = YES;
[self.view addSubview:_codeInputView];
[_codeInputView mas_makeConstraints:^(MASConstraintMaker *make) {
    make.width.equalTo(self.view.mas_width).multipliedBy(0.6);
    make.centerX.equalTo(self.view);
    make.height.mas_equalTo(40);
    make.top.equalTo(topTitleL.mas_bottom).offset(15);
}];
YBWeakSelf;
_codeInputView.changeEvent = ^{
    
};
_codeInputView.finishEvent = ^{
    //NSLog(@"input:%@",weakSelf.codeInputView.codeText);
    [weakSelf inputFinish];
};
// 关键点:更新布局
[self.view layoutIfNeeded];
[_codeInputView updateSubViews];

</code></pre></div></div>

<h4 id="rkcodeinputview类暴露外部使用"><code class="language-plaintext highlighter-rouge">RKCodeInputView</code>类暴露外部使用</h4>

<p><strong>.h</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
#import &lt;UIKit/UIKit.h&gt;

#import "RKCodeView.h"

NS_ASSUME_NONNULL_BEGIN

typedef void (^inputFinishBlock)(void);

@interface RKCodeInputView : UIView

///验证码文字
@property (strong, nonatomic) NSString *codeText;

///设置验证码位数 默认 4 位
@property (nonatomic) NSInteger codeCount;

///验证码数字之间的间距 默认 35
@property (nonatomic) CGFloat codeSpace;

@property(nonatomic,assign)CodeUIStyle uiStyle;

@property(nonatomic,copy)inputFinishBlock finishEvent;

@property(nonatomic,copy)inputFinishBlock changeEvent;
///放置小格子
@property (strong, nonatomic) UIView *contentView;

/// 键盘类型
@property(nonatomic,assign)UIKeyboardType keyboardType;
@property(nonatomic,strong)UIFont *textFont;
@property(nonatomic,strong)UIColor *textCor;

@property(nonatomic,assign)BOOL becomeFirstRes;

/// 密文
@property(nonatomic,assign)BOOL secureTextEntry;
/// 清空
-(void)clearText;
/// 取消光标
-(void)cancelCursor;

- (void)updateSubViews;

@end

NS_ASSUME_NONNULL_END

</code></pre></div></div>

<p><strong>.m</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
#import "RKCodeInputView.h"
//#import "RKCodeView.h"
@interface RKCodeInputView() &lt;UITextFieldDelegate&gt;

///输入框
@property (strong, nonatomic) UITextField *textField;
///格子数组
@property (nonatomic,strong) NSMutableArray &lt;RKCodeView *&gt; *arrayTextFidld;
///记录上一次的字符串
@property (strong, nonatomic) NSString *lastString;
/////放置小格子
//@property (strong, nonatomic) UIView *contentView;

@end
@implementation RKCodeInputView

- (instancetype)init {
    if (self = [super init]) {
        [self config];
    }
    return self;
}

- (instancetype)initWithFrame:(CGRect)frame {
    self = [super initWithFrame:frame];
    if (self) {
        [self config];
    }
    return self;
}

- (void)config {
    
    _codeCount = 4;  //在初始化函数里面, 如果重写了某个属性的setter方法, 那么使用 self.codeCount 会直接调用重写的 setter 方法, 会造成惊喜!
    _codeSpace = 20;
    
    //初始化数组
    _arrayTextFidld = [NSMutableArray array];
    
    _lastString = @"";
    
    self.backgroundColor = UIColor.blackColor;
    
    //输入框
    _textField = [[UITextField alloc] init];
    _textField.backgroundColor = [UIColor purpleColor];
    _textField.keyboardType = UIKeyboardTypeNumberPad;
    _textField.delegate = self;
    [self addSubview:_textField];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(textFieldDidChangeValue:) name:UITextFieldTextDidChangeNotification object:_textField];
    
    //放置View
    _contentView = [[UIView alloc] init];
    _contentView.backgroundColor = UIColor.clearColor;
    _contentView.userInteractionEnabled = NO;
    [self addSubview:_contentView];
}
- (void)setBecomeFirstRes:(BOOL)becomeFirstRes {
    _becomeFirstRes = becomeFirstRes;
    if (_becomeFirstRes) {
        [_textField becomeFirstResponder];
    }
}
- (void)setKeyboardType:(UIKeyboardType)keyboardType {
    _keyboardType = keyboardType;
    _textField.keyboardType = _keyboardType;
}
- (void)layoutSubviews {
    [super layoutSubviews];
    
    //改为外部主动调用
    //[self updateSubViews];
}

- (void)updateSubViews {
    
    self.textField.frame = self.bounds;
    self.contentView.frame = self.bounds;
    
    /*
     方案1: 直接把原来的都删掉, 重新创建
     for (SMSCodeView *v in [self.arrayTextFidld reverseObjectEnumerator]) {
     [v removeFromSuperview];
     [self.arrayTextFidld removeObject:v];
     }
     */
    
    //方案2:能用就用,少了再建
    if (_arrayTextFidld.count &lt; _codeCount) { //已经存在的子控件比新来的数要小, 那么就创建
        NSUInteger c = _codeCount - _arrayTextFidld.count;
        for (NSInteger i = 0; i &lt; c; i ++) {
            RKCodeView *v = [[RKCodeView alloc] init];
            if (_textFont) {
                v.textFont = _textFont;
            }
            if (_textCor) {
                v.textCor = _textCor;
            }
            if (_uiStyle) {
                v.uiStyle = _uiStyle;
            }
            if (_secureTextEntry) {
                v.secureTextEntry = _secureTextEntry;
            }
            [_arrayTextFidld addObject:v];
        }
    } else if (_arrayTextFidld.count == _codeCount) { //个数相等
        
        return; //如果return,那么就是什么都不做, 如果不return, 那么后续可以更新颜色之类, 或者在转屏的时候重新布局
        
    } else if (_arrayTextFidld.count &gt; _codeCount) { //个数有多余, 那么不用创建新的, 为了尽可能释放内存, 把不用的移除掉,
        NSUInteger c = _arrayTextFidld.count - _codeCount;
        for (NSInteger i = 0; i &lt; c; i ++) {
            [_arrayTextFidld.lastObject removeFromSuperview];
            [_arrayTextFidld removeLastObject];
        }
    }
    
    //可用宽度 / 格子总数
    CGFloat w = (self.bounds.size.width - _codeSpace * (_codeCount - 1)) / (_codeCount * 1.0);
    
    //重新布局小格子
    for (NSInteger i = 0; i &lt; _arrayTextFidld.count; i ++) {
        RKCodeView *t = _arrayTextFidld[i];
        [self.contentView addSubview:t];
        t.frame = CGRectMake(i * (w + _codeSpace), 0, w, self.bounds.size.height);
        [t updateCodeView];
    }
}

//已经编辑
- (void)textFieldDidChangeValue:(NSNotification *)notification {
    
    
    UITextField *sender = (UITextField *)[notification object];

    /*
     bug: NSUInteger.
     sender.text.length 返回值是 NSUInteger,无符号整型, 当两个无符号整型做减法, 如果 6 - 9, 那么不会得到 -3, 而是一串很长的整型数, 也就是计算失误
     */
    BOOL a = sender.text.length &gt;= self.lastString.length;
    BOOL b = sender.text.length - self.lastString.length &gt;= _codeCount;
    if (a &amp;&amp; b) { //判断为一连串验证码输入, 那么,最后N个,就是来自键盘上的短信验证码,取最后N个
        NSLog(@"一连串的输入");
        sender.text = [sender.text substringFromIndex:sender.text.length - _codeCount];
    }
    /*
    if (sender.text.length &gt;= _codeCount + 1) { //对于持续输入,只要前面N个就行 sender.text.length &gt;= _codeCount + 1
        NSLog(@"持续输入");
        sender.text = [sender.text substringToIndex:_codeCount - 1];
    }
    */
    BOOL shouldStop = NO;
    if (sender.text.length &gt; _codeCount) {
        NSLog(@"持续输入");
        shouldStop = YES;
        sender.text = [sender.text substringToIndex:_codeCount];
    }
    if (shouldStop) {
        return;
    }
    
    //字符串转数组
    NSMutableArray &lt;NSString *&gt; *stringArray = [NSMutableArray array];
    NSString *temp = nil;
    for(int i = 0; i &lt; [sender.text length]; i++) {
        temp = [sender.text substringWithRange:NSMakeRange(i,1)];
        [stringArray addObject:temp];
    }
    ///----&gt; 20220602 新增密文
    /*
    //设置文字
    for(int i = 0; i &lt; self.arrayTextFidld.count; i++) {
        RKCodeView *SMSCodeView = self.arrayTextFidld[i];
        if (i &lt; stringArray.count) {
            SMSCodeView.text = stringArray[i];
        } else {
            SMSCodeView.text = @"";
        }
    }
    */
    //新增密文方式解决闪烁问题
    int lastIdx = 0;
    if (a) {
        //NSLog(@"rk_code:++++:%lu===%lu",(unsigned long)self.arrayTextFidld.count,(unsigned long)stringArray.count);
        lastIdx = (int)stringArray.count - 1;
        RKCodeView *SMSCodeView = self.arrayTextFidld[lastIdx];
        SMSCodeView.text = [stringArray lastObject];
    }else{
        //NSLog(@"rk_code:----%lu===%lu",(unsigned long)self.arrayTextFidld.count,(unsigned long)stringArray.count);
        lastIdx = (int)stringArray.count;
        RKCodeView *SMSCodeView = self.arrayTextFidld[lastIdx];
        SMSCodeView.text = @"";
    }
    ///&lt;-----
    
    //设置光标
    if (stringArray.count == 0) {
        for(int i = 0; i &lt; self.arrayTextFidld.count; i++) {
            BOOL hide = (i == 0 ? YES : NO);
            RKCodeView *SMSCodeView = self.arrayTextFidld[i];
            SMSCodeView.showCursor = hide;
        }
    } else if (stringArray.count == self.arrayTextFidld.count) {
        for(int i = 0; i &lt; self.arrayTextFidld.count; i++) {
            RKCodeView *SMSCodeView = self.arrayTextFidld[i];
            SMSCodeView.showCursor = NO;
        }
    } else {
        for(int i = 0; i &lt; self.arrayTextFidld.count; i++) {
            RKCodeView *SMSCodeView = self.arrayTextFidld[i];
            if (i == stringArray.count - 1) {
                SMSCodeView.showCursor = YES;
            } else {
                SMSCodeView.showCursor = NO;
            }
        }
    }
    
    if (stringArray.count == self.arrayTextFidld.count) {
        [self.textField resignFirstResponder];
        if (self.finishEvent) {
            self.finishEvent();
        }
    }
    
    self.lastString = sender.text;
    
    if (self.changeEvent) {
        self.changeEvent();
    }
    
}

- (void)textFieldDidBeginEditing:(UITextField *)textField {
    //检查上一次的字符串
    if (self.lastString.length == 0 || self.lastString.length == 1) {
        self.arrayTextFidld.firstObject.showCursor = YES;
    } else if (self.lastString.length == self.arrayTextFidld.count) {
        self.arrayTextFidld.lastObject.showCursor = YES;
    } else {
        self.arrayTextFidld[self.lastString.length - 1].showCursor = YES;
    }
}

- (NSString *)codeText {
    return self.textField.text;
}

- (BOOL)resignFirstResponder {
    for(int i = 0; i &lt; self.arrayTextFidld.count; i++) {
        RKCodeView *SMSCodeView = self.arrayTextFidld[i];
        SMSCodeView.showCursor = NO;
    }
    [self.textField resignFirstResponder];
    return YES;
}

- (BOOL)becomeFirstResponder {
    [self.textField becomeFirstResponder];
    return YES;
}

///如果要求可以随时更改输入位数, 那么,
- (void)setCodeCount:(NSInteger)codeCount {
    _codeCount = codeCount;
    
    //因为个数改变,清空之前输入的内容
    self.lastString = @"";
    self.textField.text = @"";
    
    for (NSInteger i = 0; i &lt; _arrayTextFidld.count; i ++) {
        RKCodeView *t = _arrayTextFidld[i];
        t.text = @"";
        if (i == 0) {
            t.showCursor = YES;
        } else {
            t.showCursor = NO;
        }
    }
    
    [self setNeedsLayout];
    [self layoutIfNeeded];
}
/// 清空
-(void)clearText;{
    self.lastString = @"";
    self.textField.text = @"";
    
    for (NSInteger i = 0; i &lt; _arrayTextFidld.count; i ++) {
        RKCodeView *t = _arrayTextFidld[i];
        t.text = @"";
        if (i == 0) {
            t.showCursor = YES;
        } else {
            t.showCursor = NO;
        }
    }
    
    [self setNeedsLayout];
    [self layoutIfNeeded];
    
    [_textField becomeFirstResponder];
}
/// 取消光标
-(void)cancelCursor {
    for (RKCodeView *t in _arrayTextFidld) {
        t.showCursor = NO;
    }
    [_textField resignFirstResponder];
}

@end

</code></pre></div></div>

<h5 id="rkcodeview内部实现类可以不用关心"><code class="language-plaintext highlighter-rouge">RKCodeView</code>内部实现类,可以不用关心</h5>

<p><strong>.h</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import &lt;UIKit/UIKit.h&gt;

NS_ASSUME_NONNULL_BEGIN

typedef NS_ENUM(NSInteger,CodeUIStyle) {
    CodeUIStyle_Block,
    CodeUIStyle_Line,
};

@interface RKCodeView : UIView

///文字
@property (nonatomic, strong) NSString *text;

///显示光标 默认关闭
@property (nonatomic) BOOL showCursor;

@property(nonatomic,assign)CodeUIStyle uiStyle;

@property(nonatomic,strong)UIFont *textFont;
@property(nonatomic,strong)UIColor *textCor;
/// 密文
@property(nonatomic,assign)BOOL secureTextEntry;
-(void)updateCodeView;
@end

NS_ASSUME_NONNULL_END

</code></pre></div></div>

<p><strong>.m</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#import "RKCodeView.h"

@interface RKCodeView()

@property (nonatomic, strong) UILabel *codeLabel;
@property (nonatomic, strong) UIView *codeEdgeView;
@property (nonatomic, strong) UIView *cursor;

@end

@implementation RKCodeView

- (instancetype)init {
    self = [super init];
    if (self) {
        [self config];
    }
    return self;
}

- (instancetype)initWithFrame:(CGRect)frame {
    self = [super initWithFrame:frame];
    if (self) {
        [self config];
    }
    return self;
}

- (void)config {
    
    self.userInteractionEnabled = NO;
    
    _codeEdgeView = [[UIView alloc] init];
    _codeEdgeView.userInteractionEnabled = NO;
    _codeEdgeView.backgroundColor = UIColor.clearColor;
    _codeEdgeView.layer.borderWidth = 1;
    _codeEdgeView.layer.borderColor = UIColor.clearColor.CGColor;
    _codeEdgeView.layer.cornerRadius = 5;
    _codeEdgeView.backgroundColor = RGB_COLOR(@"#f6f6f6", 1);
    [self addSubview:_codeEdgeView];
    
    _codeLabel = [[UILabel alloc] init];
    _codeLabel.font = [UIFont boldSystemFontOfSize:15];
    _codeLabel.textColor = UIColor.blackColor;
    [self addSubview:_codeLabel];
    
    //默认关闭
    _showCursor = NO;
}
- (void)setUiStyle:(CodeUIStyle)uiStyle {
    _uiStyle = uiStyle;
    if (_uiStyle == CodeUIStyle_Line) {
        _codeEdgeView.backgroundColor = UIColor.clearColor;
        _codeEdgeView.layer.borderColor = UIColor.whiteColor.CGColor;
    }else{
        _codeEdgeView.backgroundColor = RGB_COLOR(@"#f6f6f6", 1);
        _codeEdgeView.layer.borderColor = UIColor.clearColor.CGColor;
    }
}
- (void)setTextFont:(UIFont *)textFont {
    _textFont = textFont;
    _codeLabel.font = _textFont;
}
- (void)setTextCor:(UIColor *)textCor {
    _textCor = textCor;
    _codeLabel.textColor = _textCor;
}
- (void)layoutSubviews {
    [super layoutSubviews];
    
    [self updateCodeView];
}
-(void)updateCodeView {
    
    CGFloat edgeSize = MIN(self.frame.size.width, self.frame.size.height);
    CGFloat edgeX = (self.frame.size.width - edgeSize)/2;
    CGFloat edgeY = (self.frame.size.height - edgeSize)/2;
    self.codeEdgeView.frame = CGRectMake(edgeX, edgeY, edgeSize, edgeSize);
    
    CGFloat codeHeight = edgeSize *0.8;
    CGFloat codeX = (self.frame.size.width - self.codeLabel.frame.size.width) / 2.0;
    CGFloat codeY = (self.frame.size.height - codeHeight)/2;
    self.codeLabel.frame = CGRectMake(codeX, codeY, self.codeLabel.frame.size.width, codeHeight);
    
    [self updateCursorFrame];
}
- (void)setText:(NSString *)text {
    _text = text;
    NSLog(@"real:%@",text);
    if (_text.length &gt; 0) {
//        _codeEdgeView.layer.borderColor = UIColor.redColor.CGColor;
    } else {
//        _codeEdgeView.layer.borderColor = UIColor.grayColor.CGColor;
    }
    // 密文处理
    if (_secureTextEntry) {
        if (text.length&gt;0) {
            _codeLabel.text = text;
            [self refreshCodeLabel];
        }
        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.2 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
            if (text.length&gt;0) {
                _codeLabel.text = @"●";
            }else{
                _codeLabel.text = @"";
            }
            [self refreshCodeLabel];
        });
    }else{
        _codeLabel.text = text;
        [self refreshCodeLabel];
    }
}
-(void)refreshCodeLabel {
    [self.codeLabel sizeToFit];
    [self setNeedsLayout];
    [self layoutIfNeeded];
}
- (void)updateCursorFrame {
    CGFloat x = 0;
    if (self.codeLabel.frame.size.width &lt;= 0) {
        x = (self.frame.size.width - 1.6) / 2.0;
    } else {
        x = CGRectGetMaxX(self.codeLabel.frame);
    }
    CGFloat curHeight = self.frame.size.height *0.45;
    CGFloat curY = (self.frame.size.height - curHeight)/2;
    //_cursor.frame = CGRectMake(x, 10, 1.6, self.frame.size.height - 20);
    _cursor.frame = CGRectMake(x, curY, 1.6, curHeight);
}

- (void)setShowCursor:(BOOL)showCursor {
    
    if (_showCursor == YES &amp;&amp; showCursor == YES) { //重复开始, 那么,什么也不做
    } else if (_showCursor == YES &amp;&amp; showCursor == NO) { //原来是开始的, 现在要求关闭, 那么,就关闭
        [_cursor removeFromSuperview];
    } else if (_showCursor == NO &amp;&amp; showCursor == YES) { //原来是关闭, 现在要求开始, 那么, 开始
        _cursor = [[UIView alloc] init];
        _cursor.userInteractionEnabled = NO;
        _cursor.backgroundColor = Pink_Cor;
        [self addSubview:_cursor];
        [self updateCursorFrame];
        _cursor.alpha = 0;
        [self animationOne:_cursor];
    } else if (_showCursor == NO &amp;&amp; showCursor == NO) { //重复关闭
        [_cursor removeFromSuperview];
    }
    _showCursor = showCursor;
}

// 光标效果
- (void)animationOne:(UIView *)aView {
    [UIView animateWithDuration:0.1 delay:0 options:UIViewAnimationOptionCurveEaseIn animations:^{
        aView.alpha = 1;
    } completion:^(BOOL finished) {
        if (self.showCursor) {
            [self performSelector:@selector(animationTwo:) withObject:aView afterDelay:0.5];
        }
    }];
}

- (void)animationTwo:(UIView *)aView {
    [UIView animateWithDuration:0.3 delay:0 options:UIViewAnimationOptionCurveEaseOut animations:^{
        aView.alpha = 0;
    } completion:^(BOOL finished) {
        if (self.showCursor) {
            [self performSelector:@selector(animationOne:) withObject:aView afterDelay:0.1];
        }
    }];
}


@end

</code></pre></div></div>



                <hr style="visibility: hidden;">
                
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2022/06/06/%E5%AF%BC%E8%88%AA/" data-toggle="tooltip" data-placement="top" title="导航">
                        上一篇:<span>导航</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2022/06/08/%E6%9D%80%E8%BF%9B%E7%A8%8B/" data-toggle="tooltip" data-placement="top" title="iOS如何优雅的杀掉进程">
                        下一篇:<span>iOS如何优雅的杀掉进程</span>
                        </a>
                    </li>
                    
                </ul>
                

            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                            
                                <a href="/tags/#iOS" title="iOS" rel="31">
                                    iOS
                                </a>
                            
                        
                            
                                <a href="/tags/#OC" title="OC" rel="59">
                                    OC
                                </a>
                            
                        
                            
                                <a href="/tags/#C" title="C" rel="26">
                                    C
                                </a>
                            
                        
                            
                                <a href="/tags/#Xcode" title="Xcode" rel="11">
                                    Xcode
                                </a>
                            
                        
                            
                                <a href="/tags/#MIMEType" title="MIMEType" rel="1">
                                    MIMEType
                                </a>
                            
                        
                            
                                <a href="/tags/#屏幕旋转" title="屏幕旋转" rel="1">
                                    屏幕旋转
                                </a>
                            
                        
                            
                                <a href="/tags/#Mac" title="Mac" rel="9">
                                    Mac
                                </a>
                            
                        
                            
                                <a href="/tags/#工具" title="工具" rel="4">
                                    工具
                                </a>
                            
                        
                            
                                <a href="/tags/#SQLite3" title="SQLite3" rel="1">
                                    SQLite3
                                </a>
                            
                        
                            
                                <a href="/tags/#重命名" title="重命名" rel="1">
                                    重命名
                                </a>
                            
                        
                            
                                <a href="/tags/#证书+内购" title="证书+内购" rel="1">
                                    证书+内购
                                </a>
                            
                        
                            
                                <a href="/tags/#像素" title="像素" rel="1">
                                    像素
                                </a>
                            
                        
                            
                                <a href="/tags/#pch" title="pch" rel="1">
                                    pch
                                </a>
                            
                        
                            
                                <a href="/tags/#支付协议税务" title="支付协议税务" rel="1">
                                    支付协议税务
                                </a>
                            
                        
                            
                                <a href="/tags/#APP转让" title="APP转让" rel="1">
                                    APP转让
                                </a>
                            
                        
                            
                                <a href="/tags/#审核" title="审核" rel="1">
                                    审核
                                </a>
                            
                        
                            
                                <a href="/tags/#银行卡格式化" title="银行卡格式化" rel="1">
                                    银行卡格式化
                                </a>
                            
                        
                            
                                <a href="/tags/#git" title="git" rel="5">
                                    git
                                </a>
                            
                        
                            
                                <a href="/tags/#描述文件" title="描述文件" rel="2">
                                    描述文件
                                </a>
                            
                        
                            
                                <a href="/tags/#命令行" title="命令行" rel="6">
                                    命令行
                                </a>
                            
                        
                            
                                <a href="/tags/#沙盒日志" title="沙盒日志" rel="1">
                                    沙盒日志
                                </a>
                            
                        
                            
                                <a href="/tags/#i386" title="i386" rel="1">
                                    i386
                                </a>
                            
                        
                            
                                <a href="/tags/#x86_64" title="x86_64" rel="1">
                                    x86_64
                                </a>
                            
                        
                            
                                <a href="/tags/#控制台log" title="控制台log" rel="1">
                                    控制台log
                                </a>
                            
                        
                            
                                <a href="/tags/#xcode10&iOS12" title="xcode10&iOS12" rel="1">
                                    xcode10&iOS12
                                </a>
                            
                        
                            
                                <a href="/tags/#正则" title="正则" rel="2">
                                    正则
                                </a>
                            
                        
                            
                                <a href="/tags/#textfield" title="textfield" rel="1">
                                    textfield
                                </a>
                            
                        
                            
                                <a href="/tags/#输入限制" title="输入限制" rel="1">
                                    输入限制
                                </a>
                            
                        
                            
                                <a href="/tags/#Pod" title="Pod" rel="3">
                                    Pod
                                </a>
                            
                        
                            
                                <a href="/tags/#真机支持" title="真机支持" rel="1">
                                    真机支持
                                </a>
                            
                        
                            
                                <a href="/tags/#封面尺寸" title="封面尺寸" rel="1">
                                    封面尺寸
                                </a>
                            
                        
                            
                                <a href="/tags/#SDWebImage" title="SDWebImage" rel="1">
                                    SDWebImage
                                </a>
                            
                        
                            
                                <a href="/tags/#Ruby" title="Ruby" rel="1">
                                    Ruby
                                </a>
                            
                        
                            
                                <a href="/tags/#RVM" title="RVM" rel="1">
                                    RVM
                                </a>
                            
                        
                            
                                <a href="/tags/#渐变色" title="渐变色" rel="1">
                                    渐变色
                                </a>
                            
                        
                            
                                <a href="/tags/#jekyll" title="jekyll" rel="1">
                                    jekyll
                                </a>
                            
                        
                            
                                <a href="/tags/#水印" title="水印" rel="1">
                                    水印
                                </a>
                            
                        
                            
                                <a href="/tags/#富文本" title="富文本" rel="1">
                                    富文本
                                </a>
                            
                        
                            
                                <a href="/tags/#标签" title="标签" rel="1">
                                    标签
                                </a>
                            
                        
                            
                                <a href="/tags/#M3U8" title="M3U8" rel="1">
                                    M3U8
                                </a>
                            
                        
                            
                                <a href="/tags/#动、静态库" title="动、静态库" rel="2">
                                    动、静态库
                                </a>
                            
                        
                            
                                <a href="/tags/#异步上传" title="异步上传" rel="1">
                                    异步上传
                                </a>
                            
                        
                            
                                <a href="/tags/#Url编码解码" title="Url编码解码" rel="1">
                                    Url编码解码
                                </a>
                            
                        
                            
                                <a href="/tags/#AlertController" title="AlertController" rel="1">
                                    AlertController
                                </a>
                            
                        
                            
                                <a href="/tags/#保活" title="保活" rel="2">
                                    保活
                                </a>
                            
                        
                            
                                <a href="/tags/#pod报错" title="pod报错" rel="1">
                                    pod报错
                                </a>
                            
                        
                            
                                <a href="/tags/#特定UI横竖屏" title="特定UI横竖屏" rel="1">
                                    特定UI横竖屏
                                </a>
                            
                        
                            
                                <a href="/tags/#Launch版本号" title="Launch版本号" rel="1">
                                    Launch版本号
                                </a>
                            
                        
                            
                                <a href="/tags/#ijkplayer" title="ijkplayer" rel="1">
                                    ijkplayer
                                </a>
                            
                        
                            
                                <a href="/tags/#适配" title="适配" rel="1">
                                    适配
                                </a>
                            
                        
                            
                                <a href="/tags/#手势" title="手势" rel="3">
                                    手势
                                </a>
                            
                        
                            
                                <a href="/tags/#截图" title="截图" rel="1">
                                    截图
                                </a>
                            
                        
                            
                                <a href="/tags/#网络和信号" title="网络和信号" rel="1">
                                    网络和信号
                                </a>
                            
                        
                            
                                <a href="/tags/#礼物缓存" title="礼物缓存" rel="1">
                                    礼物缓存
                                </a>
                            
                        
                            
                                <a href="/tags/#手绘礼物" title="手绘礼物" rel="1">
                                    手绘礼物
                                </a>
                            
                        
                            
                                <a href="/tags/#UIPickerView" title="UIPickerView" rel="1">
                                    UIPickerView
                                </a>
                            
                        
                            
                                <a href="/tags/#文件权限" title="文件权限" rel="1">
                                    文件权限
                                </a>
                            
                        
                            
                                <a href="/tags/#键盘和菜单" title="键盘和菜单" rel="1">
                                    键盘和菜单
                                </a>
                            
                        
                            
                                <a href="/tags/#耗时卡顿" title="耗时卡顿" rel="1">
                                    耗时卡顿
                                </a>
                            
                        
                            
                                <a href="/tags/#国际化" title="国际化" rel="1">
                                    国际化
                                </a>
                            
                        
                            
                                <a href="/tags/#Paypal" title="Paypal" rel="1">
                                    Paypal
                                </a>
                            
                        
                            
                                <a href="/tags/#AWSS3" title="AWSS3" rel="2">
                                    AWSS3
                                </a>
                            
                        
                            
                                <a href="/tags/#npm、Node" title="npm、Node" rel="1">
                                    npm、Node
                                </a>
                            
                        
                            
                                <a href="/tags/#控制台" title="控制台" rel="1">
                                    控制台
                                </a>
                            
                        
                            
                                <a href="/tags/#warning" title="warning" rel="1">
                                    warning
                                </a>
                            
                        
                            
                                <a href="/tags/#扩展" title="扩展" rel="5">
                                    扩展
                                </a>
                            
                        
                            
                                <a href="/tags/#防盗链" title="防盗链" rel="1">
                                    防盗链
                                </a>
                            
                        
                            
                                <a href="/tags/#动画" title="动画" rel="1">
                                    动画
                                </a>
                            
                        
                            
                                <a href="/tags/#分析" title="分析" rel="1">
                                    分析
                                </a>
                            
                        
                            
                                <a href="/tags/#CallKit" title="CallKit" rel="1">
                                    CallKit
                                </a>
                            
                        
                            
                                <a href="/tags/#侧滑" title="侧滑" rel="1">
                                    侧滑
                                </a>
                            
                        
                            
                                <a href="/tags/#重置根控制器" title="重置根控制器" rel="1">
                                    重置根控制器
                                </a>
                            
                        
                            
                                <a href="/tags/#播放器" title="播放器" rel="1">
                                    播放器
                                </a>
                            
                        
                            
                                <a href="/tags/#裁剪" title="裁剪" rel="1">
                                    裁剪
                                </a>
                            
                        
                            
                                <a href="/tags/#日志" title="日志" rel="1">
                                    日志
                                </a>
                            
                        
                            
                                <a href="/tags/#bugly" title="bugly" rel="1">
                                    bugly
                                </a>
                            
                        
                            
                                <a href="/tags/#uniapp" title="uniapp" rel="9">
                                    uniapp
                                </a>
                            
                        
                            
                                <a href="/tags/#Swift" title="Swift" rel="2">
                                    Swift
                                </a>
                            
                        
                            
                                <a href="/tags/#文字翻转" title="文字翻转" rel="1">
                                    文字翻转
                                </a>
                            
                        
                            
                                <a href="/tags/#跨域" title="跨域" rel="1">
                                    跨域
                                </a>
                            
                        
                            
                                <a href="/tags/#WebClip" title="WebClip" rel="1">
                                    WebClip
                                </a>
                            
                        
                            
                                <a href="/tags/#网络请求" title="网络请求" rel="1">
                                    网络请求
                                </a>
                            
                        
                            
                                <a href="/tags/#地图导航" title="地图导航" rel="1">
                                    地图导航
                                </a>
                            
                        
                            
                                <a href="/tags/#ZSH" title="ZSH" rel="1">
                                    ZSH
                                </a>
                            
                        
                            
                                <a href="/tags/#SPM" title="SPM" rel="1">
                                    SPM
                                </a>
                            
                        
                            
                                <a href="/tags/#Vapor" title="Vapor" rel="2">
                                    Vapor
                                </a>
                            
                        
                            
                                <a href="/tags/#导航" title="导航" rel="1">
                                    导航
                                </a>
                            
                        
                            
                                <a href="/tags/#验证码" title="验证码" rel="1">
                                    验证码
                                </a>
                            
                        
                            
                                <a href="/tags/#杀进程" title="杀进程" rel="1">
                                    杀进程
                                </a>
                            
                        
                            
                                <a href="/tags/#Ubuntu" title="Ubuntu" rel="1">
                                    Ubuntu
                                </a>
                            
                        
                            
                                <a href="/tags/#Android" title="Android" rel="1">
                                    Android
                                </a>
                            
                        
                            
                                <a href="/tags/#JWT" title="JWT" rel="1">
                                    JWT
                                </a>
                            
                        
                            
                                <a href="/tags/#vue" title="vue" rel="7">
                                    vue
                                </a>
                            
                        
                            
                                <a href="/tags/#html-js" title="html-js" rel="2">
                                    html-js
                                </a>
                            
                        
                            
                                <a href="/tags/#style-class" title="style-class" rel="3">
                                    style-class
                                </a>
                            
                        
                            
                                <a href="/tags/#ssh" title="ssh" rel="2">
                                    ssh
                                </a>
                            
                        
                            
                                <a href="/tags/#PHP" title="PHP" rel="2">
                                    PHP
                                </a>
                            
                        
                            
                                <a href="/tags/#jks" title="jks" rel="1">
                                    jks
                                </a>
                            
                        
                            
                                <a href="/tags/#css" title="css" rel="1">
                                    css
                                </a>
                            
                        
                            
                                <a href="/tags/#Runtime" title="Runtime" rel="1">
                                    Runtime
                                </a>
                            
                        
                            
                                <a href="/tags/#tree" title="tree" rel="1">
                                    tree
                                </a>
                            
                        
                            
                                <a href="/tags/#uniCloud" title="uniCloud" rel="1">
                                    uniCloud
                                </a>
                            
                        
                            
                                <a href="/tags/#总结" title="总结" rel="2">
                                    总结
                                </a>
                            
                        
                    </div>
                </section>
                               

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="http://gems.ruby-china.com/">RubyChina</a></li>
                    
                        <li><a href="https://apple.com">Apple</a></li>
                    
                        <li><a href="https://developer.apple.com/">Apple Developer</a></li>
                    
                        <li><a href="https://www.jianshu.com/u/9e754f67b0e9">简书</a></li>
                    
                        <li><a href="https://huxpro.github.io">黄玄</a></li>
                    
                        <li><a href="http://sobaigu.com/">搜百谷</a></li>
                    
                        <li><a href="https://www.jianshu.com/u/e6c8dda77e26">Swift</a></li>
                    
                        <li><a href="http://applemusic.cc/index.html">applemusic</a></li>
                    
                        <li><a href="https://blog.walterlv.com/">吕毅</a></li>
                    
                        <li><a href="https://blog.csdn.net/heipingguowenkong">黎明lh</a></li>
                    
                        <li><a href="https://www.jianshu.com/u/f8493395c623">_我们一直在路上_</a></li>
                    
                        <li><a href="https://github.com/hw20101101">Braintree-Paypal</a></li>
                    
                        <li><a href="https://zhile.io">知了</a></li>
                    
                        <li><a href="https://github.com/getlantern/lantern">LD</a></li>
                    
                        <li><a href="https://blog.ibireme.com/">YYKit</a></li>
                    
                        <li><a href="https://git-scm.com/book/en/v2">Git</a></li>
                    
                        <li><a href="https://blog.hyperzsb.tech/">Hyperzsb</a></li>
                    
                        <li><a href="https://github.com/getlantern">Lantern</a></li>
                    
                        <li><a href="https://tech.meituan.com/">美团</a></li>
                    
                        <li><a href="https://github.com/ElfSundae">工具</a></li>
                    
                        <li><a href="https://anbig.com/">anbig</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>

 <!-- 图片放大222 -->
<div id="image-cover-modal" class="image-cover-modal">
  <img id="image-cover-image" class="image-cover-modal-content">
  <div id="image-cover-caption"></div>
</div>
<script>
// Get the DOM
var modal = document.getElementById('image-cover-modal');
var modalImg = document.getElementById("image-cover-image");
var captionText = document.getElementById("image-cover-caption");
var span = document.getElementsByClassName("image-cover-close")[0];

// When the user clicks on <span> (x), close the modal
modal.onclick = function() {
    this.classList.remove("model-shown");
}

var i;
for (i = 0; i < document.images.length; i++) {

    // Get the image and insert it inside the modal - use its "alt" text as a caption
    var img = document.images[i];

    img.onclick = function(){
        modal.classList.add("model-shown");
        modalImg.src = this.src;
        captionText.innerHTML = this.alt;
    }
}
</script>





<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <!-- add jianshu add target = "_blank" to <a> by BY -->
                    
                            <li>
                                <a target="_blank" href="https://www.jianshu.com/u/Yuan920">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa  fa-stack-1x fa-inverse">简</i>
                                    </span>
                                </a>
                            </li>
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/Memory丶Rookie">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/Yuan920">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Yuan's Blog 2024
                    <br>
                    Theme on <a href="https://github.com/Yuan920/rookie777">GitHub</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=Yuan920&repo=Yuan920.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- 不蒜子 -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Service Worker -->

<script type="text/javascript">
    if(navigator.serviceWorker){
        // For security reasons, a service worker can only control the pages that are in the same directory level or below it. That's why we put sw.js at ROOT level.
        navigator.serviceWorker
            .register('/sw.js')
            .then((registration) => {console.log('Service Worker Registered. ', registration)})
            .catch((error) => {console.log('ServiceWorker registration failed: ', error)})
    }
</script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 不蒜子计数初始值纠正 -->
<script>
$(document).ready(function() {
    var int = setInterval(fixCount, 50);  // 50ms周期检测函数
    var countOffset = 20000;  // 初始化首次数据
    function fixCount() {   

        //console.log('111 '+document.getElementById("busuanzi_container_site_pv"));
        //console.log('222 '+document.getElementById("busuanzi_container_page_uv"));

       if (document.getElementById("busuanzi_container_site_pv")) {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none"){
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
                clearInterval(int);
            }                  
            if ($("#busuanzi_container_site_pv").css("display") != "none"){
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset); // 加上初始数据 
                clearInterval(int); // 停止检测
            }  
       }
       if (document.getElementById("busuanzi_container_page_uv")) {
            if (document.getElementById("busuanzi_container_page_uv").style.display != "none"){
                $("#busuanzi_value_page_pv").html(parseInt($("#busuanzi_value_page_pv").html()) + countOffset); 
                clearInterval(int);
            }                  
            if ($("#busuanzi_container_page_uv").css("display") != "none"){
                $("#busuanzi_value_page_pv").html(parseInt($("#busuanzi_value_page_pv").html()) + countOffset); // 加上初始数据 
                clearInterval(int); // 停止检测
            }  
       }
    }
});
</script> 
<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/ 
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers   
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-90855596-1';
    var _gaDomain = 'auto';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'b50bf2b12b5338a1845e33832976fd68';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;    
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>





<!-- Image to hack wechat -->
<img src="/img/apple-touch-icon.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
